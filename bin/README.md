# Программа intrade-bar-downloader.exe

Данная программа скачивает котировки брокера [intrade.bar](https://intrade.bar/), которые совпадают с брокером *FXCM*.

### Особенности использования

* Программа **не скачивает данные во время выходных дней.**
* Программа может скачивать цену *bid*, *ask* или находить цену *(bid+ask)/2*. Последний вариант подходит для бинарных опционов у брокера [intrade.bar](https://intrade.bar/), 5-ти или 3-х значная цена округляется к ближайшему значению (например, 1.6754651 округлится к 1.67547)
* Цена закрытия бара совпадает с ценой, которую фиксирует брокер [intrade.bar](https://intrade.bar/) в начале минуты. Пример:

Бар закрылся, цена закрытия бара *1.90544*
Время бара (время открытия бара): *23:58:00*
Время котировки у брокера *23:59:00*, зачение котировки *1.90544*

**Данное утверждение справедливо, если использовать цену *(bid+ask)/2*!**

* Программа скачивает данные в специальный формат [qhs5](https://github.com/NewYaroslav/xquotes_history). Данный формат использует библиотека [xquotes_history](https://github.com/NewYaroslav/xquotes_history). 
Данный формат содержит все цены бара, а также его объем. Преобразовать данный формат в файл csv можно при помощи специальной утилиты [xqhtools.exe](https://github.com/NewYaroslav/xquotes_history/tree/master/bin). Подробнее смотрите в [README](https://github.com/NewYaroslav/xquotes_history/blob/master/bin/README.md) в  папке *bin* репозитория *xquotes_history*.
* Настройки программы можно задать как через аргументы, так и через json файл.
* Программа скачивает котировки всех валютных пар (в том числе и золото), которые есть у брокера [intrade.bar](https://intrade.bar/).

### Команды программы

Все команды и флаги начинаются с символов: <-->,<-> или </>. 
Команды и флаги представлены ниже:

* path_store | ps

Директория, где будут располагаться файлы исторических данных

* use_day_off | udo | skip_day_off | sdo

Флаг *use_day_off* или *udo* отключает пропуск выходных дней (по UTC времени), флаг *skip_day_off* или *sdo* - включает пропуск выходных дней.

* use_current_day | ucd | skip_current_day | scd

Флаг *use_current_day* или *ucd* отключает пропуск текущего дня (по UTC времени), флаг *skip_current_day* или *scd* - включает пропуск текущего дня.
Это может пригодиться, если нужно скачать только полные дни.

* price_type | pt

Тип используемой цены. Данный аргумент может принимать значения: <bid>, <ask>, <(bid+ask)/2>

* path_json_file | pjf | json_file | jf

Путь к файлу *json* с настройками

### Настройка через файл JSON

* ключ *path_store* - переменная типа *string*, указывает на путь к папке с файлами хранилищ котировок, начиная от текущей директории программы или от переемнной окружения (если указана)
* ключ *environmental_variable* - переменная типа *string*, указывает на имя переменной окружения, которая должна содержать директорию. Это влияет на путь файла сертификата, файл куков и на папку с котировками
* ключ *sert_file* - переменная типа *string*, указывает на файл сертификата
* ключ *cookie_file* - переменная типа *string*, указывает на файл куков
* ключ *use_current_day* - переменная типа *bool*, включает или отключает пропуск текущего дня
* ключ *use_day_off* - переменная типа *bool*, включает или отключает пропуск выходных дней по UTC
* ключ *price_type* - переменная типа *string*, тип используемой цены. Данный аргумент может принимать значения: <bid>, <ask>, <(bid+ask)/2>
* ключ *only_broker_supported_currency_pairs* - переменная типа *bool*, включает или отключает использование только валютных пар доступных для торговли у брокера *intrade.bar*

### Пример командной строки

Пример снизу запишет файлы исторических данных в папку *../storage*, пропустит выходные дни и текущий день, а также использует цену *(bid+ask)/2*.

```
intrade-bar-downloader-18.exe /use_day_off /use_current_day /price_type "(bid+ask)/2" /path_store "../storage"
```

### Пример командной строки для задания настроек через файл JSON

```
intrade-bar-downloader-18.exe /path_json_file "settings-intrade-bar-downloader.json"
```

### Пример файла JSON

```json
{
	"path_store":"../storage",
	"use_current_day":true,
	"use_day_off":true,
	"price_type":"(bid+ask)/2"
}
```

Также, в качестве образца файла JSON можете взять файл *settings-intrade-bar-downloader-1.4.json*.

### Исходный код

Исходный код данной программы вы найдете в папке *intrade-bar-api-cpp\code_blocks\intrade-bar-downloader*
